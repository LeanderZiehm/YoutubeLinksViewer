<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Video Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        #videoContainer {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            gap: 10px;
            padding: 20px;
        }
        iframe {
            width: 300px;
            height: 200px;
            border: none;
        }
        textarea {
            width: 80%;
            height: 100px;
        }
    </style>
</head>
<body>
    <h1>YouTube Video Display</h1>
    <textarea id="videoUrls" placeholder="Enter YouTube links (one per line)"></textarea><br>
    <button onclick="addVideos()">Add Videos</button>
    <div id="videoContainer"></div>
    <script>
        const apiUrl = "http://localhost:3000/links";
        async function fetchVideos() {
            const response = await fetch(apiUrl);
            const links = await response.json();
            const videoContainer = document.getElementById("videoContainer");
            videoContainer.innerHTML = "";
            links.forEach(link => {
                const videoId = extractVideoId(link.url);
                if (videoId) {
                    const iframe = document.createElement("iframe");
                    iframe.src = `https://www.youtube.com/embed/${videoId}`;
                    videoContainer.appendChild(iframe);
                }
            });
        }
        async function addVideos() {
            const urlInput = document.getElementById("videoUrls").value;
            const urls = urlInput.split(/\s+/).filter(url => url.trim() !== "");
            const validUrls = urls.map(extractVideoId).filter(id => id);
            if (validUrls.length === 0) {
                alert("No valid YouTube URLs found");
                return;
            }
            await fetch(apiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(urls.map(url => ({ url })))
            });
            document.getElementById("videoUrls").value = "";
            fetchVideos();
        }
        function extractVideoId(url) {
            const regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }
        fetchVideos();
    </script>
</body>
</html>